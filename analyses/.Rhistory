geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
geom_point(pch=21, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
theme(legend.background = element_rect(fill=NULL, color=NULL)) +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black"))) +
theme(legend.key=element_rect(fill=NA))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
geom_point(pch=21, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
#theme(legend.background = element_rect(fill=NULL, color=NULL)) +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black"))) +
theme(legend.key=element_rect(fill=NA))
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
geom_point(pch=21, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
#theme(legend.background = element_rect(fill=NULL, color=NULL)) +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black", fill=TRUE)))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
geom_point(pch=21, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
#theme(legend.background = element_rect(fill=NULL, color=NULL)) +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black", fill=values)))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
geom_point(pch=21, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
#theme(legend.background = element_rect(fill=NULL, color=NULL)) +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black", fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2")
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1") + ylab("PCoA 2") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
mtext(paste("PCoA 1 (", explainvar1, "%)", sep = ""), side = 1, line = 3, cex = 1.5)
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab(""PCoA 1 (", explainvar1, "%)", sep = "") + ylab("PCoA 2") +
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (", explainvar1, "%)", sep = "") + ylab("PCoA 2") +
labs(color = "Crop diversity")
explainvar1
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (", explainvar1, "%)", sep = "")
explainvar1 #Include in PCoA 1 axis label
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (", explainvar1, "%)") + ylab("PCoA 2")
explainvar1 #Include in PCoA 1 axis label
explainvar2 #Include in PCoA 2 axis label
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)" + ylab("PCoA 2 (14.0%)")
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)")
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
ggsave("16SrRNA_BCC_Rplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(BD.DIVsoilmicrobes, aes(rotation,Hdiversity))
p + geom_boxplot() + theme_bw()
p + geom_boxplot() + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, angle=30, size=14), panel.border = element_rect(colour = "black",size=1.25)) + theme(axis.ticks.length=unit(0.3,"cm")) + xlab("Crop Diversity") + ylab("Shannon Diversity Index (H')") +scale_x_discrete(breaks=c("fallow", "CSW-2cov", "CSW-1cov", "CSW",
"CS", "C-1cov", "C"), labels=c("fallow", "CSW_2cov", "CSW_1cov", "CSW", "CS","C_1cov", "mC"))
ggsave("HdiversityRplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(data.prnd, aes(rotation,copies))
p + geom_boxplot() + theme_bw()
p + geom_boxplot() + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, angle=30, size=14), panel.border = element_rect(colour = "black",size=1.25)) + theme(axis.ticks.length=unit(0.3,"cm")) + xlab("Crop Diversity") + ylab("Log copy number of prnD gene/g soil") +scale_x_discrete(breaks=c("fallow", "CSW-2cov", "CSW-1cov", "CSW", "CS", "C-1cov", "C"), labels=c("fallow", "CSW_2cov", "CSW_1cov", "CSW", "CS","C_1cov", "mC"))
ggsave("prnDabundanceRplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
source("../bin/DiversityFunctions.R")
require("ecodist")
new.data <- read.csv("~../data/PHLD_TRFLP.csv", header=TRUE)
new.data <- read.csv("../data/PHLD_TRFLP.csv", header=TRUE)
str(new.data)
sampleREL.dist <- vegdist(decostand((new.data[,-c(1:9)]),method="log"),method="bray")
phld_pcoa <- cmdscale(sampleREL.dist,k=3,eig=TRUE,add=FALSE)
explainvar1 <- round(WL_pcoa$eig[1]/sum(WL_pcoa$eig)*100,2)
explainvar1 <- round(phld_pcoa$eig[1]/sum(WL_pcoa$eig)*100,2)
phld_pcoa <- cmdscale(sampleREL.dist,k=3,eig=TRUE,add=FALSE)
explainvar1 <- round(phld_pcoa$eig[1]/sum(phld_pcoa$eig)*100,2)
explainvar2 <- round(phld_pcoa$eig[2]/sum(phlD_pcoa$eig)*100,2)
explainvar1 <- round(phld_pcoa$eig[1]/sum(phld_pcoa$eig)*100,2)
explainvar2 <- round(phld_pcoa$eig[2]/sum(phld_pcoa$eig)*100,2)
explainvar3 <- round(phld_pcoa$eig[3]/sum(phld_pcoa$eig)*100,2)
explainvar1
explainvar2
explainvar3
pcoap <- merge(as.data.frame(phld_pcoa$points),new.data$rotation, by=0,all.x=T)
rownames(pcoap) <- rownames(phld_pcoa$points)
treatments <- new.data$rotation
levels(treatments) <- c("fallow", "CSW-2cov", "CSW-1cov", "CSW", "CS", "C-1cov", "C", "S", "W")
points <- cbind(as.data.frame(phld_pcoa$points), treatments)
L.centroids <- melt(points, id="treatments", measure.vars = c("V1", "V2", "V3"))
require("reshape")
require("ggplot2")
require("ade4")
require("grid"); require("png")
require("png")
pcoap <- merge(as.data.frame(phld_pcoa$points),new.data$rotation, by=0,all.x=T)
rownames(pcoap) <- rownames(phld_pcoa$points)
treatments <- new.data$rotation
levels(treatments) <- c("fallow", "CSW-2cov", "CSW-1cov", "CSW", "CS", "C-1cov", "C", "S", "W")
points <- cbind(as.data.frame(phld_pcoa$points), treatments)
L.centroids <- melt(points, id="treatments", measure.vars = c("V1", "V2", "V3"))
centroids <- cast(L.centroids, treatments ~ variable, mean)
centroids <- cast(L.centroids, treatments ~ variable, fun.aggregate=c(mean,se))
se <- function(x, ...){sd(x, na.rm = TRUE)/sqrt(length(na.omit(x)))}
ci <- function(x, ...){1.96 * sd(x,na.rm = TRUE)}
centroids <- cast(L.centroids, treatments ~ variable, fun.aggregate=c(mean,se))
df <- as.data.frame(cent.dataframe)
cent.dataframe <- cast(L.centroids, treatments ~ variable, fun.aggregate=c(mean,se))
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
points <- cbind(as.data.frame(phld_pcoa$points), treatments)
L.centroids <- melt(points, id="treatments", measure.vars = c("V1", "V2"))
centroids <- cast(L.centroids, variable ~ treatments, mean)
centroids.se <- cast(L.centroids, variable ~ treatments, se)
centroids.sd <- cast(L.centroids, variable ~ treatments, sd)
cent.dataframe <- t(data.frame(rbind(centroids[1,-1], centroids[2,-1],
centroids.sd[1,-1],centroids.sd[2,-1])))
colnames(cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
cent.treats <- rownames(cent.dataframe)
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
points <- cbind(as.data.frame(BD_pcoa$points), treatments)
sampleREL.dist <- vegdist(BDdataREL, method="bray")
rm(list=ls())
setwd("~/GitHub/CropDiversity/analyses")
se <- function(x, ...){sd(x, na.rm = TRUE)/sqrt(length(na.omit(x)))}
ci <- function(x, ...){1.96 * sd(x,na.rm = TRUE)}
# Code Dependencies
source("../bin/DiversityFunctions.R")
source("../bin/MothurTools.R")
require("vegan")
require("reshape")
require("ggplot2")
require("ade4")
require("grid")
require("png")
# Import Environmental Data
design.in <- read.csv("../data/BDsoil_exptdesign.csv", row.names = 1)
# ID S and W treatments
SnW <- rownames(design.in[which(design.in$rotation == "S" |
design.in$rotation == "W"), ])
# Remove S and W treatments
design <- design.in[-(which(rownames(design.in) %in% SnW)), ]
design <- droplevels(design)
# Define Treatments
treatments <- design$rotation
levels(treatments) <- c("fallow", "CSW-2cov", "CSW-1cov", "CSW",
"CS", "C-1cov", "C")
BDdata.in <- read.otu("../data/BD.shared")
# Remove Mock Community, Blank and Undetermined
BDdata.in2 <- BDdata.in[grepl("BD[0-9][0-9]", rownames(BDdata.in)), ]
# Remove S and W Treatments
SnW2 <- gsub("-", "", SnW)
BDdata.in2 <- BDdata.in2[-(which(rownames(BDdata.in2) %in% SnW2)), ]
# Remove OTUs with less than two occurences across all sites
BDdata <- BDdata.in2[, which(colSums(BDdata.in2) >= 2)]
# Make Presence Absence Matrix
BDdataPA <- (BDdata > 0) * 1
# Make Relative Abundence Matrices
BDdataREL <- BDdata
for(i in 1:dim(BDdata)[1]){
BDdataREL[i,] <- BDdata[i,]/sum(BDdata[i,])
}
# Log Transform Relative Abundances
BDdataREL.log <- decostand(BDdataREL, method="log")
# Import Taxonomy File
BD.tax <- read.tax(taxonomy = "../data/BD.0.03.cons.taxonomy")
BDveg.in <- read.csv("../data/BDveg.csv", row.names = 1)
# Remove S and W Treatments
BDveg <- BDveg.in[-(which(rownames(BDveg.in) %in% SnW)), ]
# plant data as discrete and continuous biomass data: rotation	crop_numb	covercrop_g	weeds_g	crop_g	biomass_total	covercrop_prop	weeds_prop	crop_prop
#16S rRNA total bacterial diversity
#Treatment <- read.csv("Treatment.csv", header=TRUE)
#trt.bact <- Treatment[,1:6]
#spp richness, species number
richness <- specnumber(BDdata[,-c(1:1)])
BD.richness <-cbind(design,richness)
write.table(BD.richness, file="BD.richness.csv", sep=",", col.names=NA)
#Shannon diversity
Hdiversity <-diversity(BDdataREL[,-c(1:1)])
BD.diversity <-cbind(design,Hdiversity)
write.table(BD.diversity, file="BD.diversity.csv", sep=",", col.names=NA)
#evenness
J <- Hdiversity/log(specnumber(BDdata[,-c(1:1)]))
BD.evenness <-cbind(design,J)
write.table(BD.evenness, file="BD.evennessty.csv", sep=",", col.names=NA)
#combined richness, diversity, dominance, evenness
BD.DIVsoilmicrobes <- cbind(design,richness,Hdiversity,J)
write.table(BD.DIVsoilmicrobes, file="BD.DIVsoilmicrobes.csv", sep=",", col.names=NA)
#correlation crop_number and Hdiversity
BD.DIVsoilmicrobes <-read.csv("BD.DIVsoilmicrobes.csv", header=TRUE)
A=read.csv ("BD.DIVsoilmicrobes.csv", header=TRUE)
cor(A$crop_numb, A$Hdiversity) #r=0.10
#ANOVA - richness, H, J
lm.richness=lm(richness~rotation+block,data=BD.DIVsoilmicrobes)
summary(lm.richness)
lm.Jevenness=lm(J~rotation+block,data=BD.DIVsoilmicrobes)
summary(lm.Jevenness)
lm.Hdiversity=lm(Hdiversity~rotation+block,data=BD.DIVsoilmicrobes)
summary(lm.Hdiversity)
library(agricolae)
lm.Hdiversity <- lm(Hdiversity~rotation,data=BD.DIVsoilmicrobes)
summary(lm.Hdiversity)
HSD <- HSD.test(lm.Hdiversity,"rotation", console=TRUE)
p <- ggplot(BD.DIVsoilmicrobes, aes(rotation,Hdiversity))
p + geom_boxplot() + theme_bw()
p + geom_boxplot() + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, angle=30, size=14), panel.border = element_rect(colour = "black",size=1.25)) + theme(axis.ticks.length=unit(0.3,"cm")) + xlab("Crop Diversity") + ylab("Shannon Diversity Index (H')") +scale_x_discrete(breaks=c("fallow", "CSW-2cov", "CSW-1cov", "CSW",
"CS", "C-1cov", "C"), labels=c("fallow", "CSW_2cov", "CSW_1cov", "CSW", "CS","C_1cov", "mC"))
ggsave("HdiversityRplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
data.prnd <- read.csv("../data/PRND gene_NoSW.csv", header=TRUE)
lm.prnd=lm(copies~rotation+block,data=data.prnd)
summary(lm.prnd)
library(agricolae)
lm.prnd <- lm(copies~rotation,data=data.prnd)
summary(lm.prnd)
HSD <- HSD.test(lm.prnd,"rotation", console=TRUE)
p <- ggplot(data.prnd, aes(rotation,copies))
p + geom_boxplot() + theme_bw()
p + geom_boxplot() + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, angle=30, size=14), panel.border = element_rect(colour = "black",size=1.25)) + theme(axis.ticks.length=unit(0.3,"cm")) + xlab("Crop Diversity") + ylab("Log copy number of prnD gene/g soil") +scale_x_discrete(breaks=c("fallow", "CSW-2cov", "CSW-1cov", "CSW", "CS", "C-1cov", "C"), labels=c("fallow", "CSW_2cov", "CSW_1cov", "CSW", "CS","C_1cov", "mC"))
ggsave("prnDabundanceRplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
reg <- lm(adj_copies~crop+carbon+moisture, data=data.prnd)
summary(reg)
# Check that Bac and Plant data have same structure as design
row.names(BDdataREL) == row.names(design)
#PERMANOVA on rotation effect - no S and W
new.data <-cbind(design,BDdataREL)
adonis = adonis(new.data[,-c(1:15)] ~ rotation+block, method = "bray", data = new.data, perm=1000)
adonis
#png(filename="../figures/WL.bac.PCoA.png",
#width = 1200, height = 800, res = 96*2)
# Create Distance Matrix
sampleREL.dist <- vegdist(BDdataREL, method="bray")
# Principal Coordinates Analysis
BD_pcoa <- cmdscale(sampleREL.dist, k=3, eig=TRUE, add=FALSE)
# Classical (Metric) Multidimensional Scaling; returns PCoA coordinates
# eig=TRUE returns eigenvalues; k = # of dimensions to calculate
explainvar1 <- round(BD_pcoa$eig[1] / sum(BD_pcoa$eig), 3) * 100
explainvar2 <- round(BD_pcoa$eig[2] / sum(BD_pcoa$eig), 3) * 100
sum.eig <- sum(explainvar1, explainvar2)
points <- cbind(as.data.frame(BD_pcoa$points), treatments)
L.centroids <- melt(points, id="treatments", measure.vars = c("V1", "V2"))
centroids <- cast(L.centroids, variable ~ treatments, mean)
centroids.se <- cast(L.centroids, variable ~ treatments, se)
centroids.sd <- cast(L.centroids, variable ~ treatments, sd)
cent.dataframe <- t(data.frame(rbind(centroids[1,-1], centroids[2,-1],
centroids.sd[1,-1],centroids.sd[2,-1])))
colnames(cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
cent.treats <- rownames(cent.dataframe)
explainvar1 #Include in PCoA 1 axis label 29.3%
explainvar2 #Include in PCoA 2 axis label 14.0%
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
ggsave("16SrRNA_BCC_Rplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.005), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.05), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(size=6) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 6,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(size=5) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 5,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 6, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
df <- as.data.frame(cent.dataframe)
p <- ggplot(df, aes(x=V1, y=V2, colour=cent.treats)) + theme_bw()
p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(size=5) +
scale_colour_manual(labels = c("mC", "C_1cov", "CS", "CSW", "CSW_1cov", "CSW_2cov", "fallow"),   values = c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF")) +
geom_point(shape=1, size = 5,colour = "black") +
theme(axis.title=element_text(size=16,face="bold"), axis.text=element_text(size=14), axis.text.x   = element_text(size=14), panel.border = element_rect(colour = "black",size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (29.3%)") + ylab("PCoA 2 (14.0%)") +
labs(color = "Crop diversity") +
guides(colour = guide_legend(override.aes = list(pch=21, size = 4, colour="black",
fill=c("#FFFFCC", "#FFFF00", "#FF9933", "#66CC00", "#339900", "#336633", "#00CCFF"))))
ggsave("16SrRNA_BCC_Rplot.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
